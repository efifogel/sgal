BASEDIR =.
MULTITHREAD =1
USE_SHARED =1
USE_SHARED_SGAL =1
USE_SHARED_SCGAL =1
USE_SHARED_SEGO =1

include $(ROOT)/make/comdef.mak

BASENAME = knot
TARGET0 = $(BASENAME)$(EXEFILESUFFIX)
INSTALLDIR0 = $(BINDIR)

ifeq ($(DE), msvc)
ifeq ($(COMPILER_VER), 1400)
MANIFEST_FILE = $(TARGET0).manifest
TARGET1 = $(MANIFEST_FILE)
INSTALLDIR1 = $(BINDIR)
else
ifeq ($(COMPILER_VER), 1500)
MANIFEST_FILE = $(TARGET0).manifest
TARGET1 = $(MANIFEST_FILE)
INSTALLDIR1 = $(BINDIR)
else
ifeq ($(COMPILER_VER), 1600)
MANIFEST_FILE = $(TARGET0).manifest
TARGET1 = $(MANIFEST_FILE)
INSTALLDIR1 = $(BINDIR)
endif
endif
endif
LMAKEDEPENDFLAGS+= -DBOOST_TOKENIZER_JRB070303_HPP_
LMAKEDEPENDFLAGS+= -DBOOST_TRANSFORM_ITERATOR_23022003THW_HPP
LMAKEDEPENDFLAGS+= -DBOOST_FILESYSTEM_PATH_HPP
LMAKEDEPENDFLAGS+= -DBOOST_FILESYSTEM_DIRECTORY_HPP
LMAKEDEPENDFLAGS+= -DBOOST_FILESYSTEM_EXCEPTION_HPP
LMAKEDEPENDFLAGS+= -DBOOST_FILESYSTEM_OPERATIONS_HPP
LMAKEDEPENDFLAGS+= -DBOOST_RANDOM_HPP
LMAKEDEPENDFLAGS+= -DBOOST_RANDOM_CONST_MOD_HPP
LMAKEDEPENDFLAGS+= -DBOOST_RANDOM_LINEAR_CONGRUENTIAL_HPP
LMAKEDEPENDFLAGS+= -DBOOST_RANDOM_UNIFORM_INT_HPP
LMAKEDEPENDFLAGS+= -DPROGRAM_OPTIONS_VP_2003_05_19
LMAKEDEPENDFLAGS+= -D_MACHINE__DEFAULT_TYPES_H
LMAKEDEPENDFLAGS+= -DBOOST_RESULT_OF_HPP
LMAKEDEPENDFLAGS+= -DBOOST_TYPE_TRAITS_HPP
LMAKEDEPENDFLAGS+= -DBOOST_MPL_AND_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MPL_OR_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MPL_TAG_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MPL_EQUAL_TO_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MPL_LOGICAL_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MPL_ASSERT_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MPL_NOT_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MPL_IF_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_UTILITY_HPP
LMAKEDEPENDFLAGS+= -DBOOST_OPTIONAL_FLC_19NOV2002_HPP
LMAKEDEPENDFLAGS+= -DBOOST_VARIANT_HPP
LMAKEDEPENDFLAGS+= -DCGAL_LAZY_H
LMAKEDEPENDFLAGS+= -DBOOST_FOREACH
LMAKEDEPENDFLAGS+= -DBOOST_UNORDERED_MAP_HPP_INCLUDED
LMAKEDEPENDFLAGS+= -DBOOST_MATH_SPECIAL_FUNCTIONS_HPP
LMAKEDEPENDFLAGS+= -DBOOST_MATH_FPCLASSIFY_HPP
LMAKEDEPENDFLAGS+= -DBOOST_UNORDERED_SET_HPP_INCLUDED
endif

CPPSOURCES = knot.cpp
CPPSOURCES+= Knot_scene.cpp
CPPSOURCES+= Knot_option_parser.cpp

LCPPINCS = -I$(BASEDIR)

# Add BOOST, GMP, MPFR, and Magick include directory:
ifdef BOOST_INC_DIR
LCPPINCS+= -I"$(BOOST_INC_DIR)"
endif

ifdef MAGICK_INC_DIR
LCPPINCS+= -I"$(MAGICK_INC_DIR)"
endif

ifeq ($(DE), gnu)
LCPPDEFS+= -DGL_GLEXT_PROTOTYPES
endif

ifeq ($(DE), msvc)
LCPPDEFS+=-DBOOST_ALL_DYN_LINK
LCPPOPTS =-GR
LCPPOPTS+= -vmg

# Add BOOST, GMP, MFFR, and Magick lib directories:
ifdef MAGICK_LIB_DIR
LLDOPTS+= -libpath:"$(MAGICK_LIB_DIR)"
endif
ifdef BOOST_LIB_DIR
LLDOPTS+= -libpath:"$(BOOST_LIB_DIR)"
endif

LLDLIBS+= $(LDSYSLIBS)
LLDLIBS+= SGAL.lib gl2ps.lib
LLDLIBS+= glu32.lib opengl32.lib
ifeq ($(COMPILER_VER), 1200)
ifeq ($(DEBUG), 1)
LLDLIBS+= stlport_vc6_stldebug_static.lib
else
LLDLIBS+= stlport_vc6_static.lib
endif
endif
ifeq ($(DEBUG), 1)
ifeq ($(COMPILER_VER), 1200)
LLDOPTS+= -nodefaultlib:libcd
LLDOPTS+= -nodefaultlib:libcmtd
endif
ifeq ($(COMPILER_VER), 1310)
LLDOPTS+= -nodefaultlib:libc
LLDOPTS+= -nodefaultlib:msvcrt
endif
else
endif
LIBS+= $(LIBDIR)/gl2ps.lib
LIBS+= $(LIBDIR)/SGAL.lib
endif

ifeq ($(DE), gnu)
LCPPOPTS = -Wall
# LCPPOPTS+= -pedantic
LLDOPTS+= -L/usr/X11R6/lib
LLDLIBS+= -lSGAL -lgl2ps
LLDLIBS+= -lMagick++
LLDLIBS+= -lboost_program_options$(BOOST_LIBNAME_SUFFIX)
LLDLIBS+= -lboost_filesystem$(BOOST_LIBNAME_SUFFIX)
LLDLIBS+= -lboost_system$(BOOST_LIBNAME_SUFFIX)
LLDLIBS+= -lXxf86vm
LLDLIBS+= -lGLU -lGL
LLDLIBS+= -lXi
# LLDLIBS+= -lXmu

LIBS =
ifneq ($(USE_SHARED_SGAL), 1)
LIBS+= $(LIBDIR)/libSGAL.a
endif
endif

LDIRT = parse.output

include $(MAKEDIR)/basedir.mak
include $(MAKEDIR)/comrul.mak
include $(MAKEDIR)/bisoncpp.mak
include $(MAKEDIR)/lexcpp.mak
include $(MAKEDIR)/comp.mak
include $(MAKEDIR)/targlink.mak
