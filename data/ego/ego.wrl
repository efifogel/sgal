#VRML V2.0 utf8
Configuration {
  accumulation Accumulation { enabled TRUE }
}
ColorBackground {
  color 0.5 0.5 0.5 0
  clearStencil TRUE
}
NavigationInfo { type [ "EXAMINE" "ANY" ] }
Viewpoint {
  # type "ORTHOGONAL"
  # fieldOfView 3.04
  radiusScale 0.7
}

DEF TRANSFORMER_NAV NavigationInfo { type [ "TRANSFORM" ] }
DEF EXPORT_KEY SingleKeySensor { key "O" }
DEF SNAP_KEY SingleKeySensor { key "S" }
DEF AOS_MODEL_VISIBLE_KEY SingleKeySensor { key "m" }
DEF AOS_EGO_VISIBLE_KEY SingleKeySensor { key "e" }

DEF SNAP Snapshot {
  image Image { }
  fileFormat "jpg"
  sequence FALSE
  dirName "."
  fileName "ego_tetrahedron"
}

Transform {
  rotation 1 0 0 -1.5707
  #bboxCenter 0 0 0
  #bboxSize 1.5 1.5 1.5
  children [
    DEF SWITCH_MODEL Switch {
      whichChoice -1
      children [
	Shape {
	  appearance Appearance {
	    material Material {}
	  }
	  geometry DEF MODEL Polyhedron {
	    coord Coordinate {
	      point [0 0 1.732051,
		     1.632993 0 -0.5773503,
		     -0.8164966 1.414214 -0.5773503,
		     -0.8164966 -1.414214 -0.5773503,
		    ]
	    }
	    coordIndex [0,1,2,-1,
			0,2,3,-1,
			0,3,1,-1,
			1,3,2,-1,
		       ]
	  }
	}
       ]
    }
    DEF SWITCH_EGO Switch {
      whichChoice 0
      children [
	DEF GEOM Ego {
	  appearance Appearance {
	    material Material {
	      diffuseColor 0.7 0.7 0.7
	      ambientIntensity 0.2
	      transparency 0
	    }
	    # texture ImageTexture { url ["negx.jpg"] }
	    texture CubeEnvironment {
	      rightImage Image { flip FALSE url ["posx.jpg"] }
	      leftImage Image { flip FALSE url ["negx.jpg"] }
	      backImage Image { flip FALSE url ["posy.jpg"] }
	      frontImage Image { flip FALSE url ["negy.jpg"] }
	      topImage Image { flip FALSE url ["posz.jpg"] }
	      bottomImage Image { flip FALSE url ["negz.jpg"] }
	    }
	  }
	  # style "appearance"
	  scale 100 100 100
	  model USE MODEL
	  brickTypes [
	    2, 4, 1, 
	    4, 2, 1,
	    2, 2, 1,
	    2, 1, 1,
	    1, 2, 1,
	    1, 1, 1
          ]

	  # parts {
	  #   children [
	  #     USE PART0
	  #     USE PART1
	  #    ]
	  # }
	}
       ]
    }

    # The axes:
    Switch {
      whichChoice 0
      children [
	DEF AXES Transform {
	  # scale 0.1 0.1 0.1
	  children [
	    Shape {
	      appearance DEF AXES_APP Appearance {
		material Material {
		  # ambientIntensity 1
		  diffuseColor 0.4 0.4 0.4
		  # specularColor 0.3 0.3 0.3
		  # transparency 0.0001
		}
	      }
	      geometry Sphere { radius 0.1 }
	    }
	    DEF CS_AXIS Transform {
	      translation 0 1.5 0
	      children [
		Shape {
		  appearance USE AXES_APP
		  geometry Cylinder {
		    radius 0.1
		    height 3
		    set_is_bottom_visible FALSE
		    set_is_top_visible FALSE
		  }
		}
		Transform {
		  translation 0 1.7 0
		  children [
		    Shape {
		      appearance USE AXES_APP
		      geometry Cone {
			bottomRadius 0.2
			height 0.4
		      }
		    }
		   ]
		}
	       ]
	    }
	    Transform {
	      rotation 0 0 -1 1.57
	      children [ USE CS_AXIS ]
	    }
	    Transform {
	      rotation 1 0 0 1.57
	      children [ USE CS_AXIS ]
	    }
	   ]
	}
       ]
    }
   ]
}

# Model visible toggle
DEF INC_MODEL_VISIBLE Incrementor {
  minValue -1
  maxValue 0
  value 0
}

ROUTE AOS_MODEL_VISIBLE_KEY.state TO INC_MODEL_VISIBLE.trigger
ROUTE INC_MODEL_VISIBLE.value TO SWITCH_MODEL.whichChoice

# Ego visible toggle
DEF INC_EGO_VISIBLE Incrementor {
  minValue -1
  maxValue 0
  value 0
}

ROUTE AOS_EGO_VISIBLE_KEY.state TO INC_EGO_VISIBLE.trigger
ROUTE INC_EGO_VISIBLE.value TO SWITCH_EGO.whichChoice

ROUTE SNAP_KEY.state TO SNAP.trigger
# ROUTE EXPORT_KEY.press TO GEOM.export
