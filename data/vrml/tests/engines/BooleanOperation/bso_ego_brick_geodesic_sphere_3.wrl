#VRML V2.0 utf8
DEF CONFIG Configuration {
  stencilBits 1
}
DEF SIM Simulation {}

ColorBackground {
  color 0.5 0.5 0.5 1
  clearStencil TRUE
}

# Viewpoint {
#   type "SIMPLE"
#   radiusScale 0.74
#   fieldOfView 0.5
#   positionTranslation 0.4 0 0
# }
DEF EXAMINE_NAV NavigationInfo { type [ "EXAMINE" "ANY" ] }

DEF SPHERE_NAVIGATION NavigationInfo {
  type [ "TRANSFORM" ]
}

DEF BRICK_NAVIGATION NavigationInfo {
  type [ "TRANSFORM" ]
}

DEF SPHERE_TRANSFORMER CoordinateTransformer {
  coord DEF SPHERE_COORD Coordinate {
    point [
	   2.764 -4.472 8.507,
	   1.552 -2.511 9.554,
	   4.36 -2.511 8.642,
	   0 0 10,
	   3.09 0 9.511,
	   5.878 0 8.09,
	   -1.552 2.511 9.554,
	   1.382 2.764 9.511,
	   4.472 2.764 8.507,
	   6.872 2.511 6.817,
	   -2.764 4.472 8.507,
	   -0.296 5.023 8.642,
	   2.629 5.257 8.09,
	   5.319 5.023 6.817,
	   7.236 4.472 5.257,
	   0.296 -5.023 8.642,
	   -2.629 -5.257 8.09,
	   -1.382 -2.764 9.511,
	   -5.319 -5.023 6.817,
	   -4.472 -2.764 8.507,
	   -3.09 0 9.511,
	   -7.236 -4.472 5.257,
	   -6.872 -2.511 6.817,
	   -5.878 0 8.09,
	   -4.36 2.511 8.642,
	   8.944 -4.472 0,
	   8.311 -5.023 2.389,
	   9.566 -2.511 1.476,
	   6.882 -5.257 5.,
	   8.618 -2.764 4.253,
	   9.511 0 3.09,
	   4.84 -5.023 7.166,
	   6.708 -2.764 6.882,
	   8.09 0 5.878,
	   8.607 2.511 4.429,
	   7.534 -6.575 0,
	   5.257 -8.507 0,
	   6.382 -7.236 2.629,
	   2.511 -9.679 0,
	   3.618 -8.944 2.629,
	   4.472 -7.236 5.257,
	   0 -10 0,
	   0.776 -9.679 2.389,
	   1.625 -8.507 5.,
	   2.328 -6.575 7.166,
	   -2.328 6.575 7.166,
	   -1.625 8.507 5.,
	   0.528 7.236 6.882,
	   -0.776 9.679 2.389,
	   1.382 8.944 4.253,
	   3.618 7.236 5.878,
	   0 10 0,
	   2.032 9.679 1.476,
	   4.253 8.507 3.09,
	   6.095 6.575 4.429,
	   -4.84 5.023 7.166,
	   -6.882 5.257 5.,
	   -4.472 7.236 5.257,
	   -8.311 5.023 2.389,
	   -6.382 7.236 2.629,
	   -3.618 8.944 2.629,
	   -8.944 4.472 0,
	   -7.534 6.575 0,
	   -5.257 8.507 0,
	   -2.511 9.679 0,
	   2.032 9.679 -1.476,
	   4.253 8.507 -3.09,
	   4.472 8.944 0,
	   6.095 6.575 -4.429,
	   6.708 7.236 -1.625,
	   6.708 7.236 1.625,
	   7.236 4.472 -5.257,
	   8.127 5.023 -2.952,
	   8.507 5.257 0,
	   8.127 5.023 2.952,
	   -0.776 9.679 -2.389,
	   -1.625 8.507 -5.,
	   1.382 8.944 -4.253,
	   -2.328 6.575 -7.166,
	   0.528 7.236 -6.882,
	   3.618 7.236 -5.878,
	   -2.764 4.472 -8.507,
	   -0.296 5.023 -8.642,
	   2.629 5.257 -8.09,
	   5.319 5.023 -6.817,
	   8.607 2.511 -4.429,
	   9.511 0 -3.09,
	   9.472 2.764 -1.625,
	   9.566 -2.511 -1.476,
	   10 0 0,
	   9.472 2.764 1.625,
	   6.872 2.511 -6.817,
	   5.878 0 -8.09,
	   8.09 0 -5.878,
	   4.36 -2.511 -8.642,
	   6.708 -2.764 -6.882,
	   8.618 -2.764 -4.253,
	   2.764 -4.472 -8.507,
	   4.84 -5.023 -7.166,
	   6.882 -5.257 -5.,
	   8.311 -5.023 -2.389,
	   1.552 -2.511 -9.554,
	   0.296 -5.023 -8.642,
	   0 0 -10,
	   -1.382 -2.764 -9.511,
	   -2.629 -5.257 -8.09,
	   -1.552 2.511 -9.554,
	   -3.09 0 -9.511,
	   -4.472 -2.764 -8.507,
	   -5.319 -5.023 -6.817,
	   -4.36 2.511 -8.642,
	   -5.878 0 -8.09,
	   -6.872 -2.511 -6.817,
	   -7.236 -4.472 -5.257,
	   3.09 0 -9.511,
	   4.472 2.764 -8.507,
	   1.382 2.764 -9.511,
	   0.776 -9.679 -2.389,
	   -2.032 -9.679 -1.476,
	   1.625 -8.507 -5.,
	   -1.382 -8.944 -4.253,
	   -4.253 -8.507 -3.09,
	   2.328 -6.575 -7.166,
	   -0.528 -7.236 -6.882,
	   -3.618 -7.236 -5.878,
	   -6.095 -6.575 -4.429,
	   3.618 -8.944 -2.629,
	   6.382 -7.236 -2.629,
	   4.472 -7.236 -5.257,
	   -4.84 5.023 -7.166,
	   -6.882 5.257 -5.,
	   -6.708 2.764 -6.882,
	   -8.311 5.023 -2.389,
	   -8.618 2.764 -4.253,
	   -8.09 0 -5.878,
	   -9.566 2.511 -1.476,
	   -9.511 0 -3.09,
	   -8.607 -2.511 -4.429,
	   -4.472 7.236 -5.257,
	   -3.618 8.944 -2.629,
	   -6.382 7.236 -2.629,
	   -9.566 2.511 1.476,
	   -9.511 0 3.09,
	   -10 0 0,
	   -8.607 -2.511 4.429,
	   -9.472 -2.764 1.625,
	   -9.472 -2.764 -1.625,
	   -8.127 -5.023 2.952,
	   -8.507 -5.257 0,
	   -8.127 -5.023 -2.952,
	   -8.618 2.764 4.253,
	   -6.708 2.764 6.882,
	   -8.09 0 5.878,
	   -6.095 -6.575 4.429,
	   -4.253 -8.507 3.09,
	   -6.708 -7.236 1.625,
	   -2.032 -9.679 1.476,
	   -4.472 -8.944 0,
	   -6.708 -7.236 -1.625,
	   -3.618 -7.236 5.878,
	   -0.528 -7.236 6.882,
	   -1.382 -8.944 4.253
	  ]
 }
}

Transform {
  rotation 1 -1 0 0.3
  children [
    DEF SPHERE_SWITCH Switch {
      whichChoice 0
      children [
	DEF TRANSFORM_SPHERE Transform {
	  translation -20 0 0
	  children [
	    DEF SELECT_SPHERE TouchSensor { enabled TRUE }
	    Shape {
	      appearance Appearance {
		material Material { diffuseColor 0.6 0.3 0.2 }
	      }
	      geometry DEF SPHERE IndexedFaceSet {
		coord USE SPHERE_COORD
		coordIndex [
			    2 1 0 -1,
			    4 3 1 -1,
			    5 4 2 -1,
			    7 6 3 -1,
			    8 7 4 -1,
			    9 8 5 -1,
			    11 10 6 -1,
			    12 11 7 -1,
			    13 12 8 -1,
			    14 13 9 -1,
			    2 4 1 -1,
			    4 7 3 -1,
			    5 8 4 -1,
			    7 11 6 -1,
			    8 12 7 -1,
			    9 13 8 -1,
			    1 15 0 -1,
			    17 16 15 -1,
			    3 17 1 -1,
			    19 18 16 -1,
			    20 19 17 -1,
			    6 20 3 -1,
			    22 21 18 -1,
			    23 22 19 -1,
			    24 23 20 -1,
			    10 24 6 -1,
			    1 17 15 -1,
			    17 19 16 -1,
			    3 20 17 -1,
			    19 22 18 -1,
			    20 23 19 -1,
			    6 24 20 -1,
			    27 26 25 -1,
			    29 28 26 -1,
			    30 29 27 -1,
			    32 31 28 -1,
			    33 32 29 -1,
			    34 33 30 -1,
			    2 0 31 -1,
			    5 2 32 -1,
			    9 5 33 -1,
			    14 9 34 -1,
			    27 29 26 -1,
			    29 32 28 -1,
			    30 33 29 -1,
			    32 2 31 -1,
			    33 5 32 -1,
			    34 9 33 -1,
			    26 35 25 -1,
			    37 36 35 -1,
			    28 37 26 -1,
			    39 38 36 -1,
			    40 39 37 -1,
			    31 40 28 -1,
			    42 41 38 -1,
			    43 42 39 -1,
			    44 43 40 -1,
			    0 44 31 -1,
			    26 37 35 -1,
			    37 39 36 -1,
			    28 40 37 -1,
			    39 42 38 -1,
			    40 43 39 -1,
			    31 44 40 -1,
			    11 45 10 -1,
			    47 46 45 -1,
			    12 47 11 -1,
			    49 48 46 -1,
			    50 49 47 -1,
			    13 50 12 -1,
			    52 51 48 -1,
			    53 52 49 -1,
			    54 53 50 -1,
			    14 54 13 -1,
			    11 47 45 -1,
			    47 49 46 -1,
			    12 50 47 -1,
			    49 52 48 -1,
			    50 53 49 -1,
			    13 54 50 -1,
			    45 55 10 -1,
			    57 56 55 -1,
			    46 57 45 -1,
			    59 58 56 -1,
			    60 59 57 -1,
			    48 60 46 -1,
			    62 61 58 -1,
			    63 62 59 -1,
			    64 63 60 -1,
			    51 64 48 -1,
			    45 57 55 -1,
			    57 59 56 -1,
			    46 60 57 -1,
			    59 62 58 -1,
			    60 63 59 -1,
			    48 64 60 -1,
			    52 65 51 -1,
			    67 66 65 -1,
			    53 67 52 -1,
			    69 68 66 -1,
			    70 69 67 -1,
			    54 70 53 -1,
			    72 71 68 -1,
			    73 72 69 -1,
			    74 73 70 -1,
			    14 74 54 -1,
			    52 67 65 -1,
			    67 69 66 -1,
			    53 70 67 -1,
			    69 72 68 -1,
			    70 73 69 -1,
			    54 74 70 -1,
			    65 75 51 -1,
			    77 76 75 -1,
			    66 77 65 -1,
			    79 78 76 -1,
			    80 79 77 -1,
			    68 80 66 -1,
			    82 81 78 -1,
			    83 82 79 -1,
			    84 83 80 -1,
			    71 84 68 -1,
			    65 77 75 -1,
			    77 79 76 -1,
			    66 80 77 -1,
			    79 82 78 -1,
			    80 83 79 -1,
			    68 84 80 -1,
			    72 85 71 -1,
			    87 86 85 -1,
			    73 87 72 -1,
			    89 88 86 -1,
			    90 89 87 -1,
			    74 90 73 -1,
			    27 25 88 -1,
			    30 27 89 -1,
			    34 30 90 -1,
			    14 34 74 -1,
			    72 87 85 -1,
			    87 89 86 -1,
			    73 90 87 -1,
			    89 27 88 -1,
			    90 30 89 -1,
			    74 34 90 -1,
			    85 91 71 -1,
			    93 92 91 -1,
			    86 93 85 -1,
			    95 94 92 -1,
			    96 95 93 -1,
			    88 96 86 -1,
			    98 97 94 -1,
			    99 98 95 -1,
			    100 99 96 -1,
			    25 100 88 -1,
			    85 93 91 -1,
			    93 95 92 -1,
			    86 96 93 -1,
			    95 98 94 -1,
			    96 99 95 -1,
			    88 100 96 -1,
			    102 101 97 -1,
			    104 103 101 -1,
			    105 104 102 -1,
			    107 106 103 -1,
			    108 107 104 -1,
			    109 108 105 -1,
			    110 81 106 -1,
			    111 110 107 -1,
			    112 111 108 -1,
			    113 112 109 -1,
			    102 104 101 -1,
			    104 107 103 -1,
			    105 108 104 -1,
			    107 110 106 -1,
			    108 111 107 -1,
			    109 112 108 -1,
			    101 94 97 -1,
			    114 92 94 -1,
			    103 114 101 -1,
			    115 91 92 -1,
			    116 115 114 -1,
			    106 116 103 -1,
			    84 71 91 -1,
			    83 84 115 -1,
			    82 83 116 -1,
			    81 82 106 -1,
			    101 114 94 -1,
			    114 115 92 -1,
			    103 116 114 -1,
			    115 84 91 -1,
			    116 83 115 -1,
			    106 82 116 -1,
			    118 117 41 -1,
			    120 119 117 -1,
			    121 120 118 -1,
			    123 122 119 -1,
			    124 123 120 -1,
			    125 124 121 -1,
			    102 97 122 -1,
			    105 102 123 -1,
			    109 105 124 -1,
			    113 109 125 -1,
			    118 120 117 -1,
			    120 123 119 -1,
			    121 124 120 -1,
			    123 102 122 -1,
			    124 105 123 -1,
			    125 109 124 -1,
			    117 38 41 -1,
			    126 36 38 -1,
			    119 126 117 -1,
			    127 35 36 -1,
			    128 127 126 -1,
			    122 128 119 -1,
			    100 25 35 -1,
			    99 100 127 -1,
			    98 99 128 -1,
			    97 98 122 -1,
			    117 126 38 -1,
			    126 127 36 -1,
			    119 128 126 -1,
			    127 100 35 -1,
			    128 99 127 -1,
			    122 98 128 -1,
			    110 129 81 -1,
			    131 130 129 -1,
			    111 131 110 -1,
			    133 132 130 -1,
			    134 133 131 -1,
			    112 134 111 -1,
			    135 61 132 -1,
			    136 135 133 -1,
			    137 136 134 -1,
			    113 137 112 -1,
			    110 131 129 -1,
			    131 133 130 -1,
			    111 134 131 -1,
			    133 135 132 -1,
			    134 136 133 -1,
			    112 137 134 -1,
			    129 78 81 -1,
			    138 76 78 -1,
			    130 138 129 -1,
			    139 75 76 -1,
			    140 139 138 -1,
			    132 140 130 -1,
			    64 51 75 -1,
			    63 64 139 -1,
			    62 63 140 -1,
			    61 62 132 -1,
			    129 138 78 -1,
			    138 139 76 -1,
			    130 140 138 -1,
			    139 64 75 -1,
			    140 63 139 -1,
			    132 62 140 -1,
			    135 141 61 -1,
			    143 142 141 -1,
			    136 143 135 -1,
			    145 144 142 -1,
			    146 145 143 -1,
			    137 146 136 -1,
			    147 21 144 -1,
			    148 147 145 -1,
			    149 148 146 -1,
			    113 149 137 -1,
			    135 143 141 -1,
			    143 145 142 -1,
			    136 146 143 -1,
			    145 147 144 -1,
			    146 148 145 -1,
			    137 149 146 -1,
			    141 58 61 -1,
			    150 56 58 -1,
			    142 150 141 -1,
			    151 55 56 -1,
			    152 151 150 -1,
			    144 152 142 -1,
			    24 10 55 -1,
			    23 24 151 -1,
			    22 23 152 -1,
			    21 22 144 -1,
			    141 150 58 -1,
			    150 151 56 -1,
			    142 152 150 -1,
			    151 24 55 -1,
			    152 23 151 -1,
			    144 22 152 -1,
			    147 153 21 -1,
			    155 154 153 -1,
			    148 155 147 -1,
			    157 156 154 -1,
			    158 157 155 -1,
			    149 158 148 -1,
			    118 41 156 -1,
			    121 118 157 -1,
			    125 121 158 -1,
			    113 125 149 -1,
			    147 155 153 -1,
			    155 157 154 -1,
			    148 158 155 -1,
			    157 118 156 -1,
			    158 121 157 -1,
			    149 125 158 -1,
			    153 18 21 -1,
			    159 16 18 -1,
			    154 159 153 -1,
			    160 15 16 -1,
			    161 160 159 -1,
			    156 161 154 -1,
			    44 0 15 -1,
			    43 44 160 -1,
			    42 43 161 -1,
			    41 42 156 -1,
			    153 159 18 -1,
			    159 160 16 -1,
			    154 161 159 -1,
			    160 44 15 -1,
			    161 43 160 -1,
			    156 42 161 -1
			   ]
	      }
	    }
	   ]
	}
       ]
    }

    DEF BRICK_SWITCH Switch {
      whichChoice 0
      children [
	DEF TRANSFORM_BRICK Transform {
	  translation 20 0 0
	  children [
	    DEF SELECT_BRICK TouchSensor { enabled TRUE }
	    Shape {
	      appearance Appearance {
		material Material { diffuseColor 0.2 0.3 0.6 }
	      }
	      geometry DEF BRICK EgoBrick {
	      	knobsVisible FALSE
		watertight TRUE
	      	numberOfKnobs1 2
	      	numberOfKnobs2 2
	      }
	    }
	   ]
	}
       ]
    }

    DEF INTERSECTION Shape {
      appearance Appearance {
    	material Material { diffuseColor 0.4 0.4 0.4 }
      }
    }
  ]
}

DEF BO BooleanOperation {
  operation "intersection"
  operand1 USE SPHERE
  operand2 USE BRICK
}

ROUTE SPHERE_NAVIGATION.rotation TO SPHERE_TRANSFORMER.rotation
ROUTE SPHERE_NAVIGATION.translation TO SPHERE_TRANSFORMER.translation
ROUTE SPHERE_TRANSFORMER.coord_changed TO SPHERE.coord
ROUTE SELECT_SPHERE.isOver TO SPHERE_NAVIGATION.set_bind

# ROUTE BRICK_NAVIGATION.rotation TO BRICK_TRANSFORMER.rotation
# ROUTE BRICK_NAVIGATION.translation TO BRICK_TRANSFORMER.translation
# ROUTE BRICK_TRANSFORMER.coord_changed TO BRICK.coord
# ROUTE SELECT_BRICK.isOver TO BRICK_NAVIGATION.set_bind

ROUTE SIM.start TO SPHERE_TRANSFORMER.execute
# ROUTE SIM.start TO BRICK_TRANSFORMER.execute

# ROUTE SIM.start TO BO.trigger
ROUTE SPHERE_TRANSFORMER.changed TO BO.trigger
ROUTE BO.result TO INTERSECTION.geometry
